import{r as a,a as S}from"./jsx-runtime-CHwbkWbZ.js";import{a as p,u as R}from"./index-CK9DHiHK.js";import{r as g}from"./index-DLo6RHam.js";import{u as O}from"./index-BpNdDISV.js";function D(e,n,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e==null||e(o),r===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}var P=S.useId||(()=>{}),h=0;function W(e){const[n,r]=a.useState(P());return p(()=>{e||r(t=>t??String(h++))},[e]),e||(n?`radix-${n}`:"")}function _({prop:e,defaultProp:n,onChange:r=()=>{}}){const[t,o]=M({defaultProp:n,onChange:r}),c=e!==void 0,d=c?e:t,f=R(r),u=a.useCallback(s=>{if(c){const i=typeof s=="function"?s(e):s;i!==e&&f(i)}else o(s)},[c,e,o,f]);return[d,u]}function M({defaultProp:e,onChange:n}){const r=a.useState(e),[t]=r,o=a.useRef(t),c=R(n);return a.useEffect(()=>{o.current!==t&&(c(t),o.current=t)},[t,o,c]),r}function v(e,n){return a.useReducer((r,t)=>n[r][t]??r,e)}var T=e=>{const{present:n,children:r}=e,t=U(n),o=typeof r=="function"?r({present:t.isPresent}):a.Children.only(r),c=O(t.ref,C(o));return typeof r=="function"||t.isPresent?a.cloneElement(o,{ref:c}):null};T.displayName="Presence";function U(e){const[n,r]=a.useState(),t=a.useRef({}),o=a.useRef(e),c=a.useRef("none"),d=e?"mounted":"unmounted",[f,u]=v(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return a.useEffect(()=>{const s=N(t.current);c.current=f==="mounted"?s:"none"},[f]),p(()=>{const s=t.current,m=o.current;if(m!==e){const A=c.current,l=N(s);e?u("MOUNT"):l==="none"||(s==null?void 0:s.display)==="none"?u("UNMOUNT"):u(m&&A!==l?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),p(()=>{if(n){const s=i=>{const l=N(t.current).includes(i.animationName);i.target===n&&l&&g.flushSync(()=>u("ANIMATION_END"))},m=i=>{i.target===n&&(c.current=N(t.current))};return n.addEventListener("animationstart",m),n.addEventListener("animationcancel",s),n.addEventListener("animationend",s),()=>{n.removeEventListener("animationstart",m),n.removeEventListener("animationcancel",s),n.removeEventListener("animationend",s)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:a.useCallback(s=>{s&&(t.current=getComputedStyle(s)),r(s)},[])}}function N(e){return(e==null?void 0:e.animationName)||"none"}function C(e){var t,o;let n=(t=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:t.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?e.ref:(n=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}export{T as P,W as a,D as c,_ as u};
